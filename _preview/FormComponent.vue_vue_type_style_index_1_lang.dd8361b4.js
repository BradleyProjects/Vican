import{d as qe,g as ne,c as I,b as C,f as Ce,n as be,h as r,j as U,w as la,v as ia,i as de,m as na,a as p,o as yr,s as Be,K as hr,V as St,t as ge,k as br,r as f,F as Nt,l as Vt,D as sa,U as ua,T as da,H as ca,u as fa,$ as ma,C as pa,e as w}from"./entry.2314a846.js";import{u as va}from"./composables.4457b5f6.js";import{u as we}from"./v4.5d18cd4f.js";import{i as ye,h as mt,v as pt,u as ha,g as ya,f as fr,a as mr,b as ba,c as ga,d as Ca,e as _a,j as Ea,k as Fa,l as wa,m as ka,n as Sa,o as Na,p as Va,q as $a,r as Aa,t as xa,w as Ia,x as za,y as Da,z as Ua,A as Pa,B as Oa,C as Ta,D as Ma,E as Ba,F as Ra}from"./TextElement.vue_vue_type_style_index_0_lang.c011c5a2.js";/* empty css            */import{f as vt,i as qa}from"./funnel_event_helper.bd666bbb.js";import{c as La}from"./Countries.69e07731.js";import{u as ht,$ as ja,x as pr,y as Ha,z as yt,w as Je,r as Ze,A as bt,q as gt,B as Ct,C as Wa,D as Ka,E as _t}from"./helpers.8b825d94.js";import{g as Ga,a as Ya,b as Ja,d as Za,s as Et,e as Ft,i as Qa}from"./Attributions.021b3c62.js";import{u as Xa}from"./index.d19945b5.js";import{a as eo,_ as ro}from"./FunnelServices.e4e13643.js";import{_ as to}from"./MoonLoader.vue_vue_type_style_index_0_lang.c5360f42.js";import{S as ao}from"./HLConst.c4c5e8b3.js";import{_ as Re}from"./InputText.vue_vue_type_script_setup_true_lang.a07991bd.js";import{A as wt}from"./index.f3ab2538.js";const oo=["type","disabled"],lo=["innerHTML"],io=["innerHTML"],no={style:{position:"absolute",left:"50%",transform:"translate(-50%, -50%)",top:"50%"},class:"loader-submit"},kt=qe({__name:"ButtonElement",props:{item:{type:Object},calendar:{type:Object},formSubmitDisable:{type:Boolean},buttonStyle:{type:Object},errors:{type:Object}},emits:["click"],setup(s,{expose:d,emit:a}){const c=s,P=function(){a("click")},K=ne(()=>{var E;let O={};return(E=c==null?void 0:c.item)!=null&&E.bgColor?O={backgroundColor:"#"+c.item.bgColor,border:c.item.border+"px "+c.item.borderType+" #"+c.item.borderColor,borderRadius:c.item.radius+"px",padding:c.item.padding.top+"px "+c.item.padding.right+"px "+c.item.padding.bottom+"px "+c.item.padding.left+"px",width:c.item.fullwidth?"100%":"auto",whiteSpace:"normal",boxShadow:c.item.shadow.horizontal+"px "+c.item.shadow.vertical+"px "+c.item.shadow.blur+"px "+c.item.shadow.spread+"px #"+c.item.shadow.color}:O={backgroundColor:"#"+(c.buttonStyle.bgColor||"2A3135"),color:"#"+(c.buttonStyle.color||"FFFFFF"),border:(c.buttonStyle.border||0)+"px solid #"+(c.buttonStyle.borderColor||"000000"),borderRadius:(c.buttonStyle.radius||0)+"px",padding:(c.buttonStyle.padding||11)+"px",width:c.item.fullwidth?"100%":"auto",whiteSpace:"normal"},O});return d({item:c.item}),(O,E)=>{var _,k,g;const q=eo;return p(),I("div",{class:"form-builder--item form-builder--btn-submit",style:be({textAlign:s.calendar?"center":s.item.align})},[C("div",{style:be([{width:s.item.fullwidth?"100%":"auto"},{display:"inline-block",position:"relative"}])},[C("button",{type:s.item.type,class:Ce([{invisible:s.formSubmitDisable,"btn btn-dark":!s.calendar,"hl_button --primary":s.calendar},"button-element"]),disabled:s.formSubmitDisable,onClick:P,style:be(r(K))},[((_=s.item)==null?void 0:_.label)&&r(ht)(s.item.label)?(p(),I("div",{key:0,style:be({color:"#"+s.item.color,fontSize:s.item.fontSize+"px",fontWeight:s.item.weight,fontFamily:s.item.fontFamily}),innerHTML:s.item.label},null,12,lo)):U("",!0),((k=s.item)==null?void 0:k.submitSubText)&&r(ht)((g=s.item)==null?void 0:g.submitSubText)?(p(),I("div",{key:1,style:be({color:"#"+s.item.subTextColor,fontSize:s.item.subTextFontSize+"px",fontWeight:s.item.subTextWeight,fontFamily:s.item.subTextFontFamily}),innerHTML:s.item.submitSubText},null,12,io)):U("",!0)],14,oo),la(C("div",no,[de(q,null,{default:na(()=>[de(to,{loading:s.formSubmitDisable,color:"#188bf6",size:"15px"},null,8,["loading"])]),_:1})],512),[[ia,s.formSubmitDisable]])],4)],4)}}});const so={key:0,class:"menu-field-wrap col-12"},uo={class:"form-builder--item"},co={key:0,class:"test-mode-badge"},fo={key:1,class:"text-light"},mo={id:"card-element",ref:"card-element",class:"field"},po={class:"outcome"},vo={key:0,class:"error",role:"alert"},ho=qe({__name:"StripePaymentElement",props:{calendar:{type:Object},payment:{type:Object},stripe:{type:Object},card:{type:Object},cardErrorMsg:{type:String}},emits:["updateStripe","updateCard","updateCardErrorMsg"],setup(s,{emit:d}){const a=s;yr(()=>{Be(()=>{c()})});const c=()=>{try{if(a.payment===void 0||!a.payment.publishable_key)return"";const E=a.payment.account_id?{stripeAccount:a.payment.account_id}:null,q=Stripe(a.payment.publishable_key,E);P(q);const k=q.elements().create("card",{style:ao,hidePostalCode:!0});K(k)}catch(E){console.log("payment",E)}},P=E=>{d("updateStripe",E)},K=E=>{d("updateCard",E)},O=E=>{d("updateCardErrorMsg",E)};return hr(()=>a.card,()=>{a.card.mount("#card-element"),a.card.addEventListener("change",E=>{E.error?O(E.error.message):O("")})}),(E,q)=>s.payment?(p(),I("div",so,[C("div",uo,[C("label",null,[St(" Secure Payment "),s.calendar.payment_mode!==void 0&&s.calendar.payment_mode===!1?(p(),I("span",co,"Test Mode")):U("",!0),s.payment.description?(p(),I("small",fo,"("+ge(s.payment.description)+")",1)):U("",!0)]),C("div",mo,null,512),C("div",po,[s.cardErrorMsg?(p(),I("div",vo,ge(s.cardErrorMsg),1)):U("",!0)])])])):U("",!0)}}),yo={class:"form-builder--item"},bo={key:0,class:"test-mode-badge"},go={key:1,class:"text-light"},Co={class:"card-number"},_o={class:"expiry-cvv-section"},Eo={class:"expiry-input"},Fo=C("label",{for:"cardExpiration"},"Expiration",-1),wo=C("label",{for:"cardExpiration"},"CVC",-1),ko={class:"error",role:"alert"},So={id:"authorize-net-error",class:"error",role:"alert"},No=qe({__name:"AuthorizeNetPaymentElement",props:{calendar:{type:Object},payment:{type:Object},setAuthorizeNetNewCardDetails:{type:Function,required:!0},authorizeNetCardNumberError:{type:Boolean,required:!0},authorizeNetCardExpiryError:{type:Boolean,required:!0},authorizeNetCardCVCError:{type:Boolean,required:!0},setAuthorizeNetCardNumberError:{type:Function,required:!0},setAuthorizeNetExpiryError:{type:Function,required:!0},setAuthorizeNetCVCError:{type:Function,required:!0},authorizeNetErrorResponse:{type:String}},setup(s){const d=s,a=br(),c=f(!1),P=f(!1),K=f(!1),O=f(!1),E=f(!1),q=f(!1),_=f(),k=f(),g=f(),h=f(""),y=f();yr(()=>{D()});const v=ne(()=>d.calendar.payment_mode!==void 0&&d.calendar.payment_mode===!1);function D(){let m=document.createElement("script"),b=v.value?a.authorizeAcceptJsUrlTestMode:a.authorizeAcceptJsUrlLiveMode;m.setAttribute("src",b),m.setAttribute("charset","utf-8"),document.head.appendChild(m)}const W=m=>{var b;$((b=m==null?void 0:m.target)==null?void 0:b.value)},$=m=>{d.setAuthorizeNetCardNumberError(!1);const b=m.replace(/\D/g,"");return c.value=!1,P.value=!1,q.value=!1,K.value=!1,O.value=!1,E.value=!1,/^3[47]\d{0,13}$/.test(b)?(c.value=!0,y.value=17,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^3(?:0[0-5]|[68]\d)\d{0,11}$/.test(b)?(P.value=!0,y.value=16,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^4[0]\d{0,11}$/.test(b)?(K.value=!0,y.value=19,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{5})/,"$1 $2 ")):/^5[12345]\d{0,13}$/.test(b)?(q.value=!0,y.value=19,_.value=m.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ")):/^5\d{0,14}$/.test(b)?(O.value=!0,y.value=17,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^6011\d{0,12}$/.test(b)||/^5\d{0,14}$/.test(b)?(O.value=!0,y.value=18,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^2131|1800\d{11}$/.test(b)?(E.value=!0,y.value=17,_.value=b.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):(y.value=19,q.value=!0,_.value=m.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ")),_.value=_.value.replace(/\s*$/,""),isNaN(Number(_.value.replace(/\s/g,"")))&&d.setAuthorizeNetCardNumberError(!0),_.value},Le=m=>{var b,se,J,te,Q;if(!_.value){d.setAuthorizeNetCardNumberError(!0);return}if(isNaN(Number(_.value.replace(/\s/g,""))))return d.setAuthorizeNetCardNumberError(!0);K&&_.value.length<15||(c.value||O.value)&&((b=_.value)==null?void 0:b.length)<17||P.value&&((se=_.value)==null?void 0:se.length)<16||q.value&&((J=_.value)==null?void 0:J.length)<19?d.setAuthorizeNetCardNumberError(!0):d.setAuthorizeNetCardNumberError(!1),c.value&&((te=g.value)==null?void 0:te.length)<4||!c.value&&((Q=g.value)==null?void 0:Q.length)<3?d.setAuthorizeNetCVCError(!0):d.setAuthorizeNetCVCError(!1),d.setAuthorizeNetNewCardDetails(_.value,k.value,g.value)},ke=m=>{m=m||window.event;var b=m.which?m.which:m.keyCode;return[37,39].indexOf(b)>-1?!0:b>31&&(b<48||b>57)?(m.preventDefault(),!1):!0},Xe=m=>{m.target.value.length>5||(d.setAuthorizeNetExpiryError(!1),k.value=m.target.value.replace(/^([1-9]\/|[2-9])$/g,"0$1 /").replace(/^(0[1-9]|1[0-2])$/g,"$1/").replace(/^([0-1])([3-9])$/g,"0$1/$2").replace(/^(0?[1-9]|1[0-2])([0-9]{2})$/g,"$1/$2").replace(/^([0]+)\/|[0]+$/g,"0").replace(/[^\d\/]|^[\/]*$/g,"").replace(/\/\//g,"/"))},je=m=>{var He;if(h.value="",!((He=m==null?void 0:m.target)!=null&&He.value)){h.value="",d.setAuthorizeNetExpiryError(!0);return}const b=m.target.value.split("/"),se=Number(b[0]),J=Number(b[1]),te=new Date().getMonth()+1,Q=new Date().getFullYear()%100;!se||!J?(h.value="",d.setAuthorizeNetExpiryError(!0)):J<Q?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration year is in the past."):J>Q+50?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration year is invalid."):se<te&&J==Q?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration month is in the past"):(h.value="",d.setAuthorizeNetExpiryError(!1)),d.setAuthorizeNetNewCardDetails(_.value,k.value,g.value)},ce=m=>{var b;g.value=(b=m==null?void 0:m.target)==null?void 0:b.value,c.value&&g.value.length<4||!c.value&&g.value.length<3?d.setAuthorizeNetCVCError(!0):d.setAuthorizeNetCVCError(!1),d.setAuthorizeNetNewCardDetails(_.value,k.value,g.value)};return(m,b)=>(p(),I("div",yo,[C("div",null,[C("label",null,[St(" Secure Payment "),r(v)?(p(),I("span",bo,"Test Mode")):U("",!0),s.payment.description?(p(),I("small",go,"("+ge(s.payment.description)+")",1)):U("",!0)]),C("span",Co,ge(_.value),1),de(Re,{type:"text",name:"cc",autocomplete:"off",value:_.value,disabled:!1,id:"cc",maxlength:y.value,placeholder:"Card number",class:Ce(["form-control",d.authorizeNetCardNumberError?"text-box-error":""]),onKeyup:W,onKeydown:ke,onChange:Le,onFocusout:Le},null,8,["value","maxlength","class"])]),C("div",_o,[C("div",Eo,[Fo,de(Re,{type:"text",name:"card-expiration",autocomplete:"off",value:k.value,disabled:!1,id:"card-expiration",maxlength:"5",placeholder:"MM / YY",class:Ce(["form-control",d.authorizeNetCardExpiryError?"text-box-error":""]),onKeydown:ke,onChange:je,onKeyup:Xe,onFocusout:je},null,8,["value","class"])]),C("div",null,[wo,de(Re,{type:"text",name:"card-cvc",value:g.value,disabled:!1,id:"card-cvc",maxlength:c.value?"4":"3",placeholder:"CVC",class:Ce(["form-control",d.authorizeNetCardCVCError?"text-box-error":""]),onChange:ce,onKeydown:ke,onFocusout:ce},null,8,["value","maxlength","class"])])]),C("div",ko,ge(h.value),1),C("div",So,ge(s.authorizeNetErrorResponse),1)]))}});var Vo=(s=>(s[s.STANDARD=0]="STANDARD",s[s.CUSTOM=1]="CUSTOM",s))(Vo||{});let Qe;const $o=()=>({channel:"APP",source:"WEB_USER",version:"2021-04-15"}),vr=s=>{const d=br().public;return ja.create({baseURL:s||d.REST_API_URLS,headers:$o()})},Ao={generateRRuleText:s=>vr()("calendars/generate-rrule-text",{method:"POST",body:s}),getRecurringSlots:(s,d)=>{Qe&&Qe.abort(),Qe=new AbortController;const a=Qe.signal;return vr()(`calendars/${s}/recurring-slots`,{params:d,signal:a})},createRecurringEvents:s=>vr()("calendars/events/recurring-appointments",{method:"POST",body:s})};function xo(){const s=f(!1),d=f(!1),a=f(!1),c=f();function P(k){E(""),s.value=k}function K(k){E(""),d.value=k}function O(k){E(""),a.value=k}function E(k){c.value=k}function q(){s.value=!1,d.value=!1,a.value=!1}async function _(k){return new Promise(function(g,h){window==null||window.Accept.dispatchData(k,function(y){var v,D;return((D=(v=y==null?void 0:y.messages)==null?void 0:v.resultCode)==null?void 0:D.toUpperCase())==="OK"?g(y):h({type:"authorizeNetServerError",response:y})})})}return{authorizeNetCardNumberError:s,authorizeNetCardExpiryError:d,authorizeNetCardCVCError:a,authorizeNetErrorResponse:c,setAuthorizeNetCardNumberError:P,setAuthorizeNetExpiryError:K,setAuthorizeNetCVCError:O,setAuthorizeNetErrorResponse:E,authorizeNetDispatchData:_,clearAuthorizeNetNewCardFormErrors:q}}const Io={id:"add-guest-container",class:"menu-field-wrap col-sm-12 col-12 calendar_notes"},zo=C("label",null,"Guests:",-1),Do=["id"],Uo=["id"],Po=C("label",null,"Guest Name *",-1),Oo={key:0,id:"error-container",class:"error"},To=["id"],Mo=C("label",null,"Guest Email *",-1),Bo={key:0,id:"error-container",class:"error"},Ro=["onClick"],qo=C("svg",{width:"17",height:"19",viewBox:"0 0 17 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[C("path",{d:"M11.6667 4.75001V4.11668C11.6667 3.22993 11.6667 2.78655 11.4941 2.44786C11.3423 2.14994 11.1001 1.90772 10.8022 1.75592C10.4635 1.58334 10.0201 1.58334 9.13333 1.58334H7.86667C6.97992 1.58334 6.53654 1.58334 6.19785 1.75592C5.89993 1.90772 5.65771 2.14994 5.50591 2.44786C5.33333 2.78655 5.33333 3.22993 5.33333 4.11668V4.75001M6.91667 9.10418V13.0625M10.0833 9.10418V13.0625M1.375 4.75001H15.625M14.0417 4.75001V13.6167C14.0417 14.9468 14.0417 15.6119 13.7828 16.1199C13.5551 16.5668 13.1918 16.9301 12.7449 17.1578C12.2369 17.4167 11.5718 17.4167 10.2417 17.4167H6.75833C5.42821 17.4167 4.76315 17.4167 4.25511 17.1578C3.80822 16.9301 3.44489 16.5668 3.21719 16.1199C2.95833 15.6119 2.95833 14.9468 2.95833 13.6167V4.75001",stroke:"#dc2626","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Lo=[qo],jo={key:0,class:"row add-guest-button"},Ho=C("svg",{width:"22",height:"20",viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[C("path",{d:"M8.00001 9.33333H5.00001C4.06964 9.33333 3.60445 9.33333 3.22592 9.44816C2.37365 9.70669 1.7067 10.3736 1.44817 11.2259C1.33334 11.6044 1.33334 12.0696 1.33334 13M12.6667 13V9M10.6667 11H14.6667M9.66668 4C9.66668 5.65685 8.32353 7 6.66668 7C5.00982 7 3.66668 5.65685 3.66668 4C3.66668 2.34315 5.00982 1 6.66668 1C8.32353 1 9.66668 2.34315 9.66668 4Z",stroke:"#4188EE","stroke-width":"1.66667","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Wo=qe({__name:"AddGuest",props:{guests:{type:Array},formFieldsValue:{type:Object}},emits:["addOrUpdateError"],setup(s,{expose:d,emit:a}){const c=s,P=f(10),K=h=>{var y;(y=c.guests)==null||y.splice(h,1)},O=()=>{var y,v;g(),((y=c.guests)==null?void 0:y.find(D=>D.name===""||D.email===""))||(v=c.guests)==null||v.push({name:"",email:""})},E=(h,y)=>{y.name=h.target.value,y.invalidName=!1,y.nameError=""},q=(h,y)=>{y.email=h.target.value,y.invalidEmail=!1,y.emailError=""},_=h=>{ye(h.name)?h.nameError="Name is required":mt(h.name)||(h.nameError="Name is invalid"),h.invalidName=!ye(h.nameError)},k=h=>{var v,D;const y=(v=c.guests)==null?void 0:v.filter(W=>{var $;return h.email===W.email||h.email===(($=c.formFieldsValue)==null?void 0:$.email)});ye(h.email)?h.emailError="Email is required":pt(h.email)?(y&&(y==null?void 0:y.length)>1||h.email===((D=c.formFieldsValue)==null?void 0:D.email))&&(h.emailError="Email ID must be unique for guests."):h.emailError="Email is invalid!",h.invalidEmail=!ye(h.emailError)},g=()=>{var h,y;a("addOrUpdateError",{tag:"guestEmail",error:void 0}),(h=c.guests)==null||h.forEach(v=>{ye(v.name)?v.nameError="Name is required":mt(v.name)||(v.nameError="Name is invalid"),ye(v.email)?v.emailError="Email is required":pt(v.email)||(v.emailError="Email is invalid!"),v.invalidName=!ye(v.nameError),v.invalidEmail=!ye(v.emailError)}),(y=c.guests)==null||y.forEach(v=>{(v.invalidName||v.invalidEmail)&&a("addOrUpdateError",{tag:"guestEmail",error:v.emailError||v.nameError})})};return d({validate:g,guests:c.guests}),(h,y)=>(p(),I("div",Io,[zo,(p(!0),I(Nt,null,Vt(s.guests,(v,D)=>(p(),I("div",{id:"guest"+D,class:"menu-field-wrap add-guest-row row"},[C("div",{id:"guest-name-"+D,class:"add-guest-name"},[Po,de(Re,{type:"text",name:"name",value:v.name,disabled:!1,id:"guest-name-text",placeholder:"Name",class:"inputBox",onChange:W=>E(W,v),onBlur:W=>_(v)},null,8,["value","onChange","onBlur"]),v.invalidName?(p(),I("div",Oo,ge(v.nameError),1)):U("",!0)],8,Uo),C("div",{id:"guest-email-"+D,class:"add-guest-email"},[Mo,de(Re,{type:"text",name:"email",value:v.email,disabled:!1,id:"guest-email-text",placeholder:"Email",class:"inputBox",onChange:W=>q(W,v),onBlur:W=>k(v)},null,8,["value","onChange","onBlur"]),v.invalidEmail?(p(),I("div",Bo,ge(v.emailError),1)):U("",!0)],8,To),C("span",{class:Ce(["add-guest-row-delete w-20",D])},[C("i",{onClick:sa(W=>K(D),["prevent"])},Lo,8,Ro)],2)],8,Do))),256)),s.guests&&s.guests.length<r(P)?(p(),I("div",jo,[Ho,C("a",{class:"action-add-guest",onClick:O},"Add Guest")])):U("",!0)]))}});const Ko={ref:"hl-app",class:"hl-app"},Go={id:"form-builder",class:"hl_form-builder--main"},Yo={key:0},Jo={key:0,class:"menu-field-wrap col-sm-12 col-12"},fl=qe({__name:"FormComponent",props:{formId:{type:String,default:void 0},formData:{type:Object||Array,required:!0},calendar:{type:Object,default:void 0},selectedSlot:{type:Object,default:void 0},timezone:{type:String,default:void 0},event:{type:Object,default:void 0},error:{type:String,default:void 0},redirect:{type:Boolean,default:!0},funnelPreview:{type:Boolean,default:!1},formElementClass:{type:String,required:!1},calendarEventId:{type:String,required:!1},forCalendarV3:{type:Boolean,default:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0},iFrameId:{type:String,default:void 0},guests:{type:Array,default:[]}},emits:["step","processError","disableBackOnSubmit","onSubmit"],setup(s,{emit:d}){var Pr;const a=s,{t:c}=ua(),P=br();let K={},O={},E={},q=f(!0),_={},k=f(!1),g=f([]),h={},y={},v={},D=f(""),W=f(!1),$=f(!0),Le={},ke=f(!1),Xe={},je={},ce=f(!1),m=f(""),b=f(!1),se=f("US"),J=f(),te=f("");f("");let Q=f(""),He=f([]),Se=f(!1);const gr=f("");let er=f(),$e=f({}),rr=f(!0),_e=f(""),fe=f(),We=f(),tr=f(),ar=f(),H=f(),ue=f(),Ae=f(),$t={},or=f(),S=f([]),A=f(!1);const lr=f(""),xe=f(),e=da({phoneCountryIncluded:K,phoneCountryCode:E,formattedPhone:O,form:_,formStyle:h,buttonStyle:y,company:Le,formFieldsValue:Xe,validationError:je,fieldStyle:v,errors:$t}),ir=f(),nr=f(),sr=f(),Ke=f(),{getFormStyle:At,setFormStyle:xt,getFormWidth:Cr}=ha(),{authorizeNetDispatchData:It,setAuthorizeNetErrorResponse:ur,authorizeNetErrorResponse:zt,authorizeNetCardNumberError:_r,authorizeNetCardExpiryError:Er,authorizeNetCardCVCError:Fr,setAuthorizeNetCardNumberError:wr,setAuthorizeNetExpiryError:kr,setAuthorizeNetCVCError:Sr,clearAuthorizeNetNewCardFormErrors:Dt}=xo(),Ut={bgColor:"E9ECEFFF",labelColor:((Pr=e==null?void 0:e.fieldStyle)==null?void 0:Pr.labelColor)||"",placeholderColor:"",border:"",width:"",padding:{top:15,bottom:15,left:20,right:20},shadow:""},Nr=l=>{S.value.push(l)},Pt=()=>{var ae,G,oe,Ee,pe,le,N,Ne,ve,T,x,Z,ee,re,ie,j,Ve,Ie,ze,De,Ue,Pe,Oe,Te,i,F,M,Y,V,B,R,z,Fe,Me,he,Or,Tr,Mr,Br,Rr,qr,Lr,jr,Hr,Wr,Kr,Gr,Yr,Jr,Zr,Qr,Xr,et,rt,tt,at,ot,lt,it,nt,st,ut,dt,ct;const{locationId:l,form:o,country:t}=a.formData;if(!l||!o)return;e.form=o,Q.value=(ae=e.form)==null?void 0:ae.fbPixelId,m.value=l,se.value=t,Se.value="stickyContact"in e.form?(G=e.form)==null?void 0:G.stickyContact:!1;const u=a.formElementClass?`.${a.formElementClass}${Ct}`:Ct;if("layout"in e.form&&(W.value=(oe=e.form)==null?void 0:oe.layout),"fields"in e.form&&(g.value=[...(Ee=e.form)==null?void 0:Ee.fields]),"style"in e.form){xt((pe=e==null?void 0:e.form)==null?void 0:pe.style,(le=e==null?void 0:e.form)==null?void 0:le.width),xe.value=(Ne=(N=a==null?void 0:a.formData)==null?void 0:N.form)==null?void 0:Ne.fieldCSS,xe.value&&!Qa()&&a.formElementClass&&(xe.value=xe.value.replace(/#_builder-form/g,`.${a.formElementClass} #_builder-form`)),ke.value=(ee=(T=(ve=e.form)==null?void 0:ve.style)==null?void 0:T.ac_branding)!=null?ee:(Z=(x=e.form)==null?void 0:x.style)==null?void 0:Z.acBranding;const ft=(ie=(re=e.form)==null?void 0:re.style)==null?void 0:ie.bgImage;ft&&(gr.value=`${a.funnelPreview?`.${a.formElementClass} #form-builder`:"body"} {background-image: url('${ft}');background-size: cover;}`)}((Ie=(Ve=(j=e.form.formAction)==null?void 0:j.headerImageSrc)==null?void 0:Ve.trim())==null?void 0:Ie.length)>0&&(lr.value=e.form.formAction.headerImageSrc),"button"in e.form&&(e.buttonStyle={bgColor:(De=(ze=e.form)==null?void 0:ze.button)==null?void 0:De.background,color:(Pe=(Ue=e.form)==null?void 0:Ue.button)==null?void 0:Pe.color,border:((i=(Te=(Oe=e.form)==null?void 0:Oe.button)==null?void 0:Te.border)==null?void 0:i.border)||0,borderColor:((Y=(M=(F=e.form)==null?void 0:F.button)==null?void 0:M.border)==null?void 0:Y.color)||Wa,radius:(R=(B=(V=e.form)==null?void 0:V.button)==null?void 0:B.border)==null?void 0:R.radius,padding:(Me=(Fe=(z=e.form)==null?void 0:z.button)==null?void 0:Fe.border)==null?void 0:Me.padding}),(Or=(he=e.form)==null?void 0:he.style)!=null&&Or.color&&(er.value=`${u}label{ color:#${(Mr=(Tr=e.form)==null?void 0:Tr.style)==null?void 0:Mr.color} }`),(Rr=(Br=e.form)==null?void 0:Br.fieldStyle)!=null&&Rr.labelColor&&(er.value=`${u}label{ color:#${e.form.fieldStyle.labelColor} }`),"fieldStyle"in e.form?e.fieldStyle={bgColor:(Lr=(qr=e==null?void 0:e.form)==null?void 0:qr.fieldStyle)==null?void 0:Lr.bgColor,labelColor:(Hr=(jr=e==null?void 0:e.form)==null?void 0:jr.fieldStyle)==null?void 0:Hr.labelColor,placeholderColor:(Kr=(Wr=e==null?void 0:e.form)==null?void 0:Wr.fieldStyle)==null?void 0:Kr.placeholderColor,border:(Yr=(Gr=e==null?void 0:e.form)==null?void 0:Gr.fieldStyle)==null?void 0:Yr.border,width:(Zr=(Jr=e==null?void 0:e.form)==null?void 0:Jr.fieldStyle)==null?void 0:Zr.width,padding:(Xr=(Qr=e==null?void 0:e.form)==null?void 0:Qr.fieldStyle)==null?void 0:Xr.padding,shadow:(rt=(et=e==null?void 0:e.form)==null?void 0:et.fieldStyle)==null?void 0:rt.shadow}:e.fieldStyle=Ut,"customStyle"in e.form&&((at=(tt=e.form)==null?void 0:tt.customStyle)==null?void 0:at.length)>0&&(D.value=e.form.customStyle.replace(".form-element","")),"company"in e.form&&(e.company=(ot=e.form)==null?void 0:ot.company),"formLabelVisible"in e.form&&($.value=(lt=e.form)==null?void 0:lt.formLabelVisible);let n=(it=e.form)==null?void 0:it.payment;n||((nt=a.calendar)==null?void 0:nt.stripe)&&(((ut=(st=a.calendar)==null?void 0:st.stripe)==null?void 0:ut.amount)==0||((ct=(dt=a.calendar)==null?void 0:dt.stripe)==null?void 0:ct.currency))&&(n=a.calendar.stripe),n&&(fe.value={default_payment_provider:n.paymentProvider,publishable_key:n.publishable_key,account_id:n.account_id,amount:(parseFloat(n.amount)*100).toFixed(2),name:n.amount?"Pay to processed":"Verify your card",description:n.charge_description,currency:n.currency}),q.value=!1},dr=Xa(),X=ca(),{$bus:Vr}=fa(),me=f([]),Ot=f(ya(a.formData));Pt();const $r=ne(()=>g.value.find(l=>l.type==="submit")),Ar=ne(()=>a.calendar&&a.calendar.enable_guests),xr=ne(()=>{var l;return((l=fe.value)==null?void 0:l.default_payment_provider)==="stripe"}),Ir=ne(()=>{var l;return((l=fe.value)==null?void 0:l.default_payment_provider)==="authorize-net"}),Tt=ne(()=>Ka.find(l=>l.code===se.value)),zr=ne(()=>J.value||se.value),Mt=ne(()=>Object.values(La));ne(()=>e.formStyle.border==="0"?"form-top-padding":""),yr(()=>{let l=!1;fr(a.urlParams,X,e.phoneCountryIncluded,H.value,e.formFieldsValue,g.value).then(o=>{e.phoneCountryIncluded=o.phoneCountryIncluded,e.formFieldsValue=o.formFieldsValue,H.value=o.formattedCountry,g.value=o.formFields}),g.value.map(o=>{if(o.type==="textbox_list"){const t={};o.picklistOptions.forEach(u=>{t[u.id]=u.prefillValue}),e.formFieldsValue[o.tag]=t}else o.type==="source"?e.formFieldsValue[o.tag]=o.value:o.type==="checkbox"&&!(e.formFieldsValue[o.tag]instanceof Array)?e.formFieldsValue[o.tag]=[]:o.type==="submit"&&(l=!0,a.calendar&&(o.label&&o.label.toLowerCase()==="button"||o.label.trim().length<=0)&&(o.label=c(a.forCalendarV3?"schedule_meeting":"book_appointment")))}),l||g.value.push({label:a.calendar?c(a.forCalendarV3?"schedule_meeting":"book_appointment"):c("submit"),tag:"button",palceholder:"button",type:"submit"}),!a.funnelPreview&&Q.value!==void 0&&Q.value!==""&&Be(()=>{qa(Q.value,e.form.pageViewEvent)}),Se.value&&(me.value=g.value.map(o=>o.tag),mr(void 0,m.value,me.value,e.formFieldsValue,e.phoneCountryIncluded,H.value).then(o=>{o?(e.formFieldsValue=o.formFieldsValue,e.phoneCountryIncluded=o.phoneCountryIncluded,H.value=o.formattedCountry):console.warn("Data not found! skippping stickycontact fill")}).catch(o=>{console.error("Failed at fillDataFromCookie",o)})),g.value.length>0&&g.value.forEach((o,t)=>{if(o.type==="html"&&o&&"html"in o){const u=o.html.replace(/[‘’]/g,"'").replace(/[“”]/g,'"');He.value.push({scriptString:u,index:t})}}),Be(()=>{k.value=!0}),_e.value=Math.random().toString(36).slice(2),Vr.$on("submitCalendarForm",Ye),X.query.hasOwnProperty("sticky_contact_help")&&X.query.sticky_contact_help==="true"&&(console.log("%c Sticky Contact data","color: black; font-weight: bold; background-color: white"),console.log("%c ===================","color: black; font-weight: bold; background-color: white"),console.log(JSON.parse(pr("_ud"))),console.log("%c ===================","color: black; font-weight: bold; background-color: white")),a.urlParams&&fr(a.urlParams,X,e.phoneCountryIncluded,H.value,e.formFieldsValue,g.value).then(o=>{e.phoneCountryIncluded=o.phoneCountryIncluded,e.formFieldsValue=o.formFieldsValue,H.value=o.formattedCountry,g.value=o.formFields}),a.stickyContactData&&Se.value&&(me.value||(me.value=g.value.map(o=>o.tag)),mr(a.stickyContactData,m.value,me.value,e.formFieldsValue,e.phoneCountryIncluded,H.value).then(o=>{e.formFieldsValue=o.formFieldsValue,e.phoneCountryIncluded=o.phoneCountryIncluded,H.value=o.formattedCountry}).catch(o=>{console.error("Failed at fillDataFromCookie at sticky contact",o)})),A.value=!0,va({__dangerouslyDisableSanitizers:["style"],style:[{children:gr.value,type:"text/css"},{children:xe.value,type:"text/css"},{children:er.value,type:"text/css"},{children:D.value,type:"text/css"}],link:[...Ot.value]})}),ma(()=>{S.value=[]}),hr(()=>a.urlParams,(l,o)=>{a.urlParams&&fr(a.urlParams,X,e.phoneCountryIncluded,H.value,e.formFieldsValue,g.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,H.value=t.formattedCountry,g.value=t.formFields})}),hr(()=>a.stickyContactData,(l,o)=>{a.stickyContactData&&Se.value&&(me.value||(me.value=g.value.map(t=>t.tag)),mr(a.stickyContactData,m.value,me.value,e.formFieldsValue,e.phoneCountryIncluded,H.value).then(t=>{e.formFieldsValue=t.formFieldsValue,e.phoneCountryIncluded=t.phoneCountryIncluded,H.value=t.formattedCountry}).catch(t=>{console.error("Failed at fillDataFromCookie at sticky contact",t)}))});const Dr=l=>{J.value=l},Bt=l=>{e.validationError=l},Rt=l=>{We.value=l},qt=l=>{tr.value=l},Lt=(l,o,t)=>{ir.value=l&&l.length?l.replace(/\s/g,""):null,o&&o.length&&o.includes("/")&&(o=o.split("/"),nr.value=o[0],sr.value=o[1]),Ke.value=t},jt=l=>{ue.value=l},Ge=l=>{const{tag:o,value:t}=l;e.formFieldsValue[o]=t},Ht=l=>{H.value=l},Wt=l=>{Ae.value=l},L=l=>{const{tag:o,error:t}=l;e.errors[o]=t,Kt(l),Ur()},Kt=l=>{const{tag:o,error:t}=l;o=="email"&&a.guests.length>=1&&a.guests.forEach(u=>{u.email===e.formFieldsValue[o]?(u.emailError="Email IDs must be unique for guests.",u.invalidEmail=!0):(u.emailError="",u.invalidEmail=!1)})},Gt=l=>{or.value=l},Yt=l=>{const{date:o,item:t}=l;e.formFieldsValue[t.tag]=o},cr=l=>{const o=e.phoneCountryIncluded[l.tag],t=e.phoneCountryCode[l.tag];e.formFieldsValue[l.tag]=o,l.tag==="phone"&&(te.value=e.formFieldsValue[l.tag]);try{const u=window.libphonenumber.parsePhoneNumberFromString(o,t);e.phoneCountryIncluded[l.tag]=u.isValid()?u.number:o,e.phoneCountryCode[l.tag]=u.country?u.country:t,e.formattedPhone[l.tag]=u.isValid()?u.formatNational():o}catch{e.phoneCountryIncluded[l.tag]=o,e.formattedPhone[l.tag]=o}},Jt=()=>{let l=!1,o=0;return g.value.map(t=>{t.type==="cascade_dropdown"&&t.required&&e.formFieldsValue[t.tag]===void 0?(rr.value=!1,l=!0):e.formFieldsValue[t.tag]!==void 0&&t.type==="cascade_dropdown"&&(e.formFieldsValue[t.tag].forEach(function(n){for(const ae in n)n[ae]===""&&o++}),o>0?(rr.value=!1,l=!0):rr.value=!0)}),l},Zt=async()=>{const l=S.value.map(t=>{t.validate&&t.validate()});return await Promise.all(l),await Ur()},Qt=async()=>{let l=!1;const o=S.value.map(t=>{var u;((u=t==null?void 0:t.item)==null?void 0:u.type)==="captcha"&&(l=!0)});return await Promise.all(o),l},Ur=async()=>{const l=Object.values(e.errors);let o=!1;return await Promise.all(l.map(t=>{t&&(o=!0)})),o},Xt=l=>{let o=0,t=0;return g.value.map(function(u,n){_t.indexOf(u.type)<0&&(o++,t=n)}),o%2!==0&&g.value[t].tag===l},ea=l=>_t.indexOf(l)>=0,ra=l=>{e.formFieldsValue[l.tag]=""},ta=l=>{const{item:o,event:t}=l;e.formFieldsValue[o.tag]=t.target.value},Ye=async l=>{var pe,le,N,Ne,ve;let o;if(l!=null&&l.isRecurring&&(o=l.isRecurring),ue.value)return;const t=o!=null?o:(pe=a.calendar)==null?void 0:pe.enable_recurring;for(let T in e.phoneCountryIncluded)e.phoneCountryIncluded[T]&&cr({tag:T});if(await ba(e.formFieldsValue)>Ha){alert("The total size of the attached files cannot be more that 50MB");return}if(e.validationError={},console.log("captchaInputValue",Ae.value),await Zt()||Jt())return;if(await Qt()&&(Ae.value===void 0||Ae.value==="0")){e.validationError.captcha="Invalid Captcha";return}let G;if(d("disableBackOnSubmit",{disable:!0}),b.value=!0,ue.value="",xr.value&&fe.value&&!ar.value){G={};try{const{client_secret:T}=await $fetch(P.serverBaseUrl+"/appointment/setup-intent",{method:"POST",body:{locationId:a.formData.locationId,calendarId:a.calendar.id}});if(!T)throw ue.value="Something went wrong while processing your payment, please try again.",new Error("clientSecret missing");let x,Z;if(e.formFieldsValue.first_name&&(Z=e.formFieldsValue.first_name.trim()),e.formFieldsValue.full_name&&(Z=e.formFieldsValue.full_name.trim()),x=await We.value.confirmCardSetup(T,{payment_method:{card:tr.value,billing_details:Z?{name:Z}:{}}},{handleActions:!1}),x.error)throw ue.value=x.error.message,x.error;{const ee={...e.formFieldsValue};if(Se.value){let j;if(typeof Storage<"u")try{j=pr(m.value)}catch{console.error("Failed to fetch contact from local storage")}j||(j=we(m.value).value||we("msgsndr_id").value),j&&(ee.contact_id=j)}te.value&&(ee.phone=te.value);const re={location_id:m.value,calendar_id:a.calendar.id,payment_method_id:x.setupIntent.payment_method,setup_intent_status:x.setupIntent.status,customer_data:ee},ie=await $fetch(P.serverBaseUrl+"/appointment/setup-stripe-customer-and-payment-intent",{method:"POST",body:re});if(ie.status==="requires_action"){const j=await We.value.handleCardAction(ie.client_secret);if(j.error)throw ue.value=j.error.message,j.error;G.payment_intent_id=j.paymentIntent.id}else G.payment_intent_id=ie.id;G.stripe_customer_id=ie.stripe_customer_id}}catch(T){return console.error(T),ue.value||(ue.value="Something went wrong while processing your payment, please try again."),d("disableBackOnSubmit",{disable:!1}),b.value=!1,!1}}if(Ir.value&&fe.value){G={};let T=!1;if(ir.value||(wr(!0),T=!0),(!nr.value||!sr.value)&&(kr(!0),T=!0),Ke.value||(Sr(!0),T=!0),T||_r.value||Er.value||Fr.value)return;ur(""),Dt();try{const{publishable_key:x,account_id:Z}=fe.value,ee={authData:{clientKey:x,apiLoginID:Z},cardData:{cardNumber:ir.value,month:nr.value,year:sr.value,cardCode:Ke.value}},re=await It(ee);G={opaqueData:re==null?void 0:re.opaqueData,cardCode:Ke.value}}catch(x){if(x.type==="authorizeNetServerError"){ur((ve=(Ne=(N=(le=x==null?void 0:x.response)==null?void 0:le.messages)==null?void 0:N.message)==null?void 0:Ne[0])==null?void 0:ve.text);return}ur((x==null?void 0:x.message)||"Something went wrong!")}}const oe=await ga(e.formFieldsValue,H.value);e.formFieldsValue=oe.formFieldsValue;const Ee=await Ca(X,g.value,e.formFieldsValue);e.formFieldsValue=Ee.formFieldsValue,await oa(G,{isRecurring:t}),d("disableBackOnSubmit",{disable:!0})},aa=l=>{const o={};for(const t in l)l.hasOwnProperty(t)&&(o[t.replace(/(\_\w)/g,function(u){return u[1].toUpperCase()})]=l[t]);return o},oa=async(l,{isRecurring:o})=>{var x,Z,ee,re,ie,j,Ve,Ie,ze,De,Ue,Pe,Oe,Te;const t=we("msgsndr_id").value;if(a.formId&&(e.formFieldsValue.formId=a.formId),e.formFieldsValue.location_id=m.value,te.value&&(e.formFieldsValue.phone=te.value),Se.value){let i;if(a.stickyContactFingerprint&&(i=a.stickyContactFingerprint),!i&&typeof Storage<"u")try{i=pr(m.value)}catch{console.error("Failed to get contact from local storage")}i||(i=we(m.value).value||t),i&&(e.formFieldsValue.contact_id=i)}const u=X.query.contact_id||((x=a.urlParams)==null?void 0:x.contact_id);u&&(e.formFieldsValue.query_contact_id=u);const n=e.formFieldsValue;let ae=null;(Z=a.calendar)!=null&&Z.form_submit_type?a.calendar.form_submit_type==="RedirectURL"&&(ae=a.calendar.form_submit_redirect_url||a.calendar.thank_you_url):((ie=(re=(ee=a.calendar)==null?void 0:ee.thank_you_url)==null?void 0:re.trim())==null?void 0:ie.length)>0&&(ae=a.calendar.thank_you_url),a.event?n.event_id=X.query.event_id:a.calendarEventId&&(n.event_id=a.calendarEventId),a.guests.length&&(n.guests=a.guests.map(({name:i,email:F})=>({name:i,email:F}))),a.calendar&&(n.calendar_id=a.calendar.id,n.selected_slot=a.selectedSlot.format(),n.selected_timezone=a.timezone),ar.value?n.stripeToken=ar.value:l&&(n.stripePaymentResult=l);const G=Ga(n.locationId);G&&(n.sessionId=G);const oe=Ya();n.eventData={...Ja(a.pageUrl,a.baseReferrrer),fbEventId:oe};let Ee=Za(n.locationId);if(Ee&&(n.sessionFingerprint=Ee),a.funnelPreview){let{domain:i,page_url:F}=X.query;i||(i=window.location.hostname,F=window.location.pathname),n.funneEventData={event_type:"optin",domain_name:i,page_url:F,funnel_id:dr.value.funnelId,page_id:dr.value.funnelPageId,funnel_step_id:dr.value.stepId}}or.value&&(n.captchaToken=or.value);let pe=P.REST_API_URLS+"/forms/submit";a.calendar&&(pe=P.serverBaseUrl+"/appointment");let le=new FormData,N={};Object.keys(n).forEach(async i=>{var F;if(n[i]instanceof File)le.append(i,n[i]);else if((F=n[i])!=null&&F.files){const M=Object.values(n[i].files);M.length&&await Promise.all(M.map(Y=>{le.append(i,Y)}))}else(n[i]||n[i]===0)&&(N[i]=n[i])}),X.query.user_id&&(N.user_id=X.query.user_id);const ve=we("am_id").value,T=we("am_fingerprint").value;if(ve&&(N.amId=ve),T&&(N.amFingerprint=T),a.calendar?(N.eventData.medium=wt.Calendar,N.eventData.mediumId=N==null?void 0:N.calendar_id):(N.eventData.medium=wt.Form,N.eventData.mediumId=N==null?void 0:N.formId),!o)le.set("formData",JSON.stringify(N)),$fetch(pe,{method:"POST",body:le}).then(async i=>{var F,M;if(i.status||i.id){let Y=i.formData,V=i.fingerprint,B=i.sessionFingerprint,R={};if(t!==V){const z=we("msgsndr_id",{path:"/",maxAge:31536e3});z.value=V}try{a.calendar&&(Y=e.formFieldsValue,V=i.contactId);const z="_ud";R=await yt(i.contact,!0),a.calendar&&(R={...R,appointment:i.appointment}),Je(z,JSON.stringify(R)),Je(m.value,V),window.parent.postMessage(["set-sticky-contacts",z,JSON.stringify(R),m.value,V],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${a.iFrameId}`,a.iFrameId,m.value,V],"*"),a.event||(Et({sessionId:i.sessionId||null,locationId:m.value}),B&&Ft(m.value,B)),d("onSubmit",{fingerprint:V})}catch(z){const Fe={formData:Y||i,eventId:i.id,error:z.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};await $fetch(P.serverBaseUrl+"/appointment/booking-error",{method:"POST",body:Fe})}if(a.calendar||Be(()=>{vt("track",e.form.formSubmissionEvent,oe)}),a.calendar){const z={contactId:i.contactId,calendarThankYouUrl:ae,id:i.id,fingerprint:V,event_address:i.event_address,cookiePayload:R,fbEventId:oe};d("step",z);return}if(a.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1){const z=Ze(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,R);bt(z)}else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!==""){const z=Ze(e.form.redirect_url||e.form.redirectUrl,R);bt(z)}else{ce.value=!0;const z=e.form.formAction.thankyouText?gt(e.form.formAction.thankyouText,R):"Thanks for submiting details, Will get back to you soon!";$e.value={action:"submit-form",message:z,style:e.form.submitMessageStyle,isFormPosted:ce.value,height:(M=(F=a.formData)==null?void 0:F.form)==null?void 0:M.height}}}}).catch(i=>{var F,M,Y,V,B,R,z,Fe,Me;if(console.error("error",i),a.calendar){let he="";((F=i==null?void 0:i.response)==null?void 0:F.status)===502?he=((Y=(M=i==null?void 0:i.response)==null?void 0:M._data)==null?void 0:Y.msg)||((B=(V=i==null?void 0:i.response)==null?void 0:V.data)==null?void 0:B.msg)||"Something went wrong with your payment. Please try again.":(he=((z=(R=i==null?void 0:i.response)==null?void 0:R._data)==null?void 0:z.msg)||((Me=(Fe=i==null?void 0:i.response)==null?void 0:Fe.data)==null?void 0:Me.msg)||c("unable_to_schedule_appointment"),he=he||"unable_to_schedule_appointment"),d("processError",{error:he})}});else try{N.source="booking_widget",N.channel="private_api";const i=await Ao.createRecurringEvents(aa(N));if(i.ids&&i.ids.length){let F,M=i.fingerprint,Y=i.sessionFingerprint,V={};try{a.calendar&&(F=e.formFieldsValue,M=i.contactId);const B="_ud";V=await yt(i.contact,!0),a.calendar&&(V={...V,appointment:i.appointment}),Je(B,JSON.stringify(V)),Je(m.value,M),window.parent.postMessage(["set-sticky-contacts",B,JSON.stringify(V),m.value,M],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${a.iFrameId}`,a.iFrameId,m.value,M],"*"),a.event||(Et({sessionId:i.sessionId||null,locationId:m.value}),Y&&Ft(m.value,Y)),d("onSubmit",{fingerprint:M})}catch(B){const R={formData:F||i,eventId:i.ids.join(","),error:B.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};await $fetch(P.serverBaseUrl+"/appointment/booking-error",{method:"POST",body:R})}if(a.calendar||Be(()=>{vt("track",e.form.formSubmissionEvent,oe)}),a.calendar){const B={contactId:i.contactId,calendarThankYouUrl:ae,ids:i.ids,fingerprint:M,event_address:i.eventAddress||"",cookiePayload:V,fbEventId:oe};d("step",B);return}if(a.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1)window.top.location.href=Ze(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,V);else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")window.top.location.href=Ze(e.form.redirect_url||e.form.redirectUrl,V);else{ce.value=!0;const B=e.form.formAction.thankyouText?gt(e.form.formAction.thankyouText,V):"Thanks for submiting details, Will get back to you soon!";$e.value={action:"submit-form",message:B,style:e.form.submitMessageStyle,isFormPosted:ce.value,height:(Ve=(j=a.formData)==null?void 0:j.form)==null?void 0:Ve.height}}}}catch(i){if(console.error("error",i),a.calendar){let F="";((Ie=i==null?void 0:i.response)==null?void 0:Ie.status)===502?F=((De=(ze=i==null?void 0:i.response)==null?void 0:ze.data)==null?void 0:De.msg)||"Something went wrong with your payment. Please try again.":(F=((Pe=(Ue=i==null?void 0:i.response)==null?void 0:Ue.data)==null?void 0:Pe.msg)||c("unable_to_schedule_appointment"),F=((Te=(Oe=i==null?void 0:i.response)==null?void 0:Oe.data)==null?void 0:Te.msg)||"unable_to_schedule_appointment"),d("processError",{error:F})}}};return pa(()=>{Vr.$off("submitCalendarForm",Ye)}),(l,o)=>(p(),I("div",Ko,[C("section",Go,[r(lr).trim().length>0&&r(A)?(p(),I("div",Yo,[C("div",{class:"max-w-full ghl-banner w-full",style:be({maxWidth:r(Cr)+"px"})},[de(ro,{url:r(lr),alt:"banner"},null,8,["url"])],4)])):U("",!0),C("div",{style:be({maxWidth:r(Cr)+"px"}),class:"ghl-form-wrap"},[r(ce)?U("",!0):(p(),I("div",{key:0,id:"_builder-form",style:be(r(At)()),name:"builder-form",class:"form-builder--wrap"},[C("div",{class:Ce([r(W)?"builder-inline":"",r($)?"":"extra-top-padding","fields-container row"])},[(p(!0),I(Nt,null,Vt(r(g),(t,u)=>(p(),I("div",{key:u,class:Ce([r(W)&&!ea(t.type)&&!Xt(t.tag)?"menu-field-wrap col-sm-6 col-6":"menu-field-wrap col-12",{calendar_notes:t.tag==="calendar_notes"},{"payment-block":t.type==="payment"}])},[C("div",{class:Ce([u%2==0?"f-even":"f-odd","form-field-container"])},[t.type==="text"&&r(A)?(p(),w(Fa,{key:0,kind:"form",item:t,"form-label-visible":r($),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(zr),"form-fields-value":r(e).formFieldsValue,"formatted-phone":r(e).formattedPhone,"phone-country-derived":r(J),errors:r(e).errors,onUpdatePhoneCountryDerived:Dr,onCustomFieldPhoneNumberUpdate:cr,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","form-fields-value","formatted-phone","phone-country-derived","errors"])):t.type==="phone"&&r(A)?(p(),w(wa,{key:1,kind:"form",item:t,"form-label-visible":r($),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(zr),"phone-country-derived":r(J),"formatted-phone":r(e).formattedPhone,errors:r(e).errors,onAddOrUpdateError:L,onUpdatePhoneCountryDerived:Dr,onCustomFieldPhoneNumberUpdate:cr,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","phone-country-derived","formatted-phone","errors"])):(t.type==="number"||t.type==="numerical")&&r(A)?(p(),w(ka,{key:2,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="email"&&r(A)?(p(),w(Sa,{key:3,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","errors"])):U("",!0),t.type==="h1"?(p(),w(Ba,{key:4,item:t},null,8,["item"])):t.type==="textbox_list"&&r(A)?(p(),w(Na,{key:5,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(_e),errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):(t.type==="textarea"||t.type=="large_text")&&r(A)?(p(),w(Va,{key:6,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="img"&&"url"in t?(p(),w(Ra,{key:7,kind:"form",item:t,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item"])):t.type==="html"?(p(),w($a,{key:8,item:t,localTagId:r(_e)+u,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","localTagId"])):t.type==="captcha"&&r(A)?(p(),w(Aa,{key:9,kind:"form",item:t,"form-label-visible":r($),"captcha-input-value":r(Ae),"local-tag-id":r(_e),"validation-error":r(e).validationError,onUpdateValidationError:Bt,onUpdateIsCaptchaVerified:Wt,onUpdateCaptchaToken:Gt,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","captcha-input-value","local-tag-id","validation-error"])):t.type==="monetory"&&r(A)?(p(),w(xa,{key:10,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"locale-currency":r(Tt),errors:r(e).errors,onAddOrUpdateError:L,onUpdateFormFieldsValue:Ge,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","locale-currency","errors"])):t.type==="checkbox"&&r(A)?(p(),w(Ia,{key:11,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(_e),errors:r(e).errors,onAddOrUpdateError:L,onUpdateFormFieldsValue:Ge,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="radio"&&t.picklistOptions&&r(A)?(p(),w(za,{key:12,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(_e),errors:r(e).errors,onAddOrUpdateError:L,onResetFieldsValue:ra,onSetRadioValue:ta,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="radio"&&t.picklistOptionsImage&&r(A)?(p(),w(Da,{key:13,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(_e),errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="select"&&t.tag=="country"&&r(A)?(p(),w(Ua,{key:14,kind:"form",item:t,"form-label-visible":r($),"formatted-country":r(H),countries:r(Mt),errors:r(e).errors,onUpdateFormattedCountry:Ht,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","formatted-country","countries","errors"])):(t.type==="single_options"||t.type==="multiple_options")&&r(A)?(p(),w(Pa,{key:15,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="date"&&r(A)?(p(),w(Oa,{key:16,kind:"form",item:t,"form-label-visible":r($),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,ref_for:!0,ref:n=>{r(S)[u]=n},onDateSelected:Yt,onAddOrUpdateError:L},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="payment"&&r(xr)&&r(A)?(p(),w(ho,{key:17,calendar:s.calendar,payment:r(fe),stripe:r(We),card:r(tr),"card-error-msg":r(ue),onUpdateStripe:Rt,onUpdateCard:qt,onUpdateCardErrorMsg:jt,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["calendar","payment","stripe","card","card-error-msg"])):t.type==="payment"&&r(Ir)&&r(A)?(p(),w(No,{key:18,kind:"form",calendar:s.calendar,payment:r(fe),setAuthorizeNetNewCardDetails:Lt,authorizeNetCardNumberError:r(_r),authorizeNetCardExpiryError:r(Er),authorizeNetCardCVCError:r(Fr),setAuthorizeNetCardNumberError:r(wr),setAuthorizeNetExpiryError:r(kr),setAuthorizeNetCVCError:r(Sr),authorizeNetErrorResponse:r(zt)},null,8,["calendar","payment","authorizeNetCardNumberError","authorizeNetCardExpiryError","authorizeNetCardCVCError","setAuthorizeNetCardNumberError","setAuthorizeNetExpiryError","setAuthorizeNetCVCError","authorizeNetErrorResponse"])):t.type==="file_upload"&&r(A)?(p(),w(Ta,{key:19,kind:"form",item:t,"form-fields-value":r(e).formFieldsValue,"form-label-visible":r($),errors:r(e).errors,onUpdateFormFieldsValue:Ge,onAddOrUpdateError:L,ref_for:!0,ref:n=>{r(S)[u]=n}},null,8,["item","form-fields-value","form-label-visible","errors"])):t.type==="signature"&&r(A)?(p(),w(Ma,{key:20,kind:"form",item:t,"form-fields-value":r(e).formFieldsValue,"form-label-visible":r($),ref_for:!0,ref:n=>{r(S)[u]=n},errors:r(e).errors,onUpdateFormFieldsValue:Ge,onAddOrUpdateError:L},null,8,["item","form-fields-value","form-label-visible","errors"])):t.type==="submit"&&r(A)&&!r(Ar)?(p(),w(kt,{key:21,item:t,"button-style":r(e).buttonStyle,calendar:s.calendar,"form-submit-disable":r(b),onClick:Ye,ref_for:!0,ref:n=>{r(S)[u]=n},errors:r(e).errors},null,8,["item","button-style","calendar","form-submit-disable","errors"])):U("",!0)],2)],2))),128)),r(Ar)?(p(),I("div",Jo,[de(Wo,{guests:s.guests,"form-fields-value":r(e).formFieldsValue,ref:t=>Nr(t),onAddOrUpdateError:L},null,8,["guests","form-fields-value"]),r($r)&&r(A)?(p(),w(kt,{key:0,item:r($r),"button-style":r(e).buttonStyle,calendar:s.calendar,"form-submit-disable":r(b),onClick:Ye,ref:t=>Nr(t),errors:r(e).errors,class:"menu-field-wrap col-sm-12 col-12 calendar_notes mt-20"},null,8,["item","button-style","calendar","form-submit-disable","errors"])):U("",!0)])):U("",!0)],2),s.formData!=null&&r(ke)&&r(A)?(p(),w(_a,{key:0,company:r(e).company},null,8,["company"])):U("",!0)],4)),r($e)&&r($e).isFormPosted?(p(),w(Ea,{key:1,id:"_builder-form",payload:r($e)},null,8,["payload"])):U("",!0)],4)])],512))}});export{Vo as A,Ao as C,fl as _};
